# Data Model Overview

## Dimensional Design

| Table | Grain | Primary Key | Purpose |
| --- | --- | --- | --- |
| `fact_sales` | Invoice-line | `invoice_line_id` | Measures each item purchased on an invoice. Stores quantity, unit price, revenue (`line_total`) and more. |
| `dim_customer` | Customer | `customer_key` | Customer master data with country. |
| `dim_product` | Stock item | `product_key` | Product attributes and latest observed unit price. |
| `dim_date` | Calendar date | `date_key` | Calendar attributes derived from `invoice_date`. |

### Relationships
* `fact_sales.customer_id` -> `dim_customer.customer_key`
* `fact_sales.stock_code` -> `dim_product.product_key`
* `fact_sales.invoice_date_key` -> `dim_date.date_key`

This star schema supports typical retail analysis such as revenue by customer country, product/category rollups (extendable), and time-based trends. `fact_sales` keeps the invoice-line grain so each row represents a unique line item on an invoice. That preserves additivity for quantity and revenue measures.

## Key Modeling Choices

* **Surrogate line key**: `invoice_line_id` is generated by concatenating invoice number with the row position, ensuring uniqueness even when the source doesnt have a line identifier.
* **Customer dimension**: The dataset provides limited customer attributes. We retain `country` and normalize `CustomerID` into `dim_customer` for future ease.
* **Product dimension**: We store the latest observed unit price to support price comparisons. Additional product hierarchies can be layered in later.
* **Date dimension**: Derives year/month/day/week fields and a numeric `date_key` (`YYYYMMDD`) to simplify joins and enable calendar analytics for any Bi operations.

## SQL DDL

See `sql/create_tables.sql` for table creation statements (A replica in SQL of our 'modelling.py').


